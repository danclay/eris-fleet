<!doctype html>
<html class="default no-js">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>eris-fleet - v0.3.9-dev</title>
	<meta name="description" content="Documentation for eris-fleet - v0.3.9-dev">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="assets/css/main.css">
	<script async src="assets/js/search.js" id="search-script"></script>
</head>
<body>
<header>
	<div class="tsd-page-toolbar">
		<div class="container">
			<div class="table-wrap">
				<div class="table-cell" id="tsd-search" data-index="assets/js/search.json" data-base=".">
					<div class="field">
						<label for="tsd-search-field" class="tsd-widget search no-caption">Search</label>
						<input id="tsd-search-field" type="text" />
					</div>
					<ul class="results">
						<li class="state loading">Preparing search index...</li>
						<li class="state failure">The search index is not available</li>
					</ul>
					<a href="index.html" class="title">eris-fleet - v0.3.9-dev</a>
				</div>
				<div class="table-cell" id="tsd-widgets">
					<div id="tsd-filter">
						<a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a>
						<div class="tsd-filter-group">
							<div class="tsd-select" id="tsd-filter-visibility">
								<span class="tsd-select-label">All</span>
								<ul class="tsd-select-list">
									<li data-value="public">Public</li>
									<li data-value="protected">Public/Protected</li>
									<li data-value="private" class="selected">All</li>
								</ul>
							</div>
							<input type="checkbox" id="tsd-filter-inherited" checked />
							<label class="tsd-widget" for="tsd-filter-inherited">Inherited</label>
							<input type="checkbox" id="tsd-filter-externals" checked />
							<label class="tsd-widget" for="tsd-filter-externals">Externals</label>
						</div>
					</div>
					<a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a>
				</div>
			</div>
		</div>
	</div>
	<div class="tsd-page-title">
		<div class="container">
			<h1>eris-fleet - v0.3.9-dev</h1>
		</div>
	</div>
</header>
<div class="container container-main">
	<div class="row">
		<div class="col-8 col-content">
			<div class="tsd-panel tsd-typography">
				<div align="center">
					<p>
						<a href="https://github.com/abalabahaha/eris"><img src="https://img.shields.io/badge/Discord%20Library-Eris-blue?style=flat-square" alt="Library" /></a>
						<a href="https://www.npmjs.com/package/eris-fleet"><img src="https://img.shields.io/npm/v/eris-fleet.svg?cacheSeconds=3600&style=flat-square" alt="NPM version" /></a>
						<a href="https://raw.githubusercontent.com/danclay/eris-fleet/master/LICENSE"><img alt="License" src="https://img.shields.io/npm/l/eris-fleet?style=flat-square">
							<a href="https://david-dm.org/danclay/eris-fleet/"><img src="https://img.shields.io/david/danclay/eris-fleet.svg?cacheSeconds=3600&style=flat-square" alt="Dependencies" /></a>
							<a href="https://david-dm.org/danclay/eris-fleet?type=peer"><img src="https://img.shields.io/david/peer/danclay/eris-fleet.svg?type=peer&cacheSeconds=3600&style=flat-square" alt="Dependencies" /></a>
							<a href="https://travis-ci.com/github/danclay/eris-fleet/builds"><img src="https://img.shields.io/travis/com/danclay/eris-fleet/master?cacheSeconds=3600&style=flat-square" alt="Build" /></a>
					</p>
					<p>
						<a href="https://www.npmjs.com/package/eris-fleet/"><img src="https://nodeico.herokuapp.com/eris-fleet.svg"></a>
					</p>
				</div>
				<a href="#documentation--eris" id="documentation--eris" style="color: inherit; text-decoration: none;">
					<h3><a href="https://danclay.github.io/eris-fleet/">Documentation</a> | <a href="https://abal.moe/Eris/docs/">Eris</a></h3>
				</a>
				<a href="#about" id="about" style="color: inherit; text-decoration: none;">
					<h1>About</h1>
				</a>
				<p>A spin-off of <a href="https://github.com/discordware/eris-sharder">eris-sharder</a> and <a href="https://github.com/brussell98/megane">megane</a> with services and configurable logging.</p>
				<p>For some more documentation check the <a href="https://danclay.github.io/eris-fleet/">docs</a> and the <a href="https://github.com/danclay/eris-fleet/blob/master/README.md">README on GitHub</a>.</p>
				<a href="#highlighted-features" id="highlighted-features" style="color: inherit; text-decoration: none;">
					<h2>Highlighted Features:</h2>
				</a>
				<ul>
					<li>Clustering across cores</li>
					<li>Sharding</li>
					<li>Recalculate shards with minimal downtime</li>
					<li>Customizable logging</li>
					<li>Fetch data from across clusters easily</li>
					<li>Services (non-eris workers)</li>
					<li>IPC to communicate between clusters, other clusters, and services</li>
					<li>Detailed stats collection</li>
					<li>Use a modified version of Eris</li>
					<li>Soft cluster and service restarts where the old worker is killed after the new one is ready</li>
					<li>Graceful shutdowns</li>
					<li>Central request handler</li>
					<li>Concurrency support</li>
				</ul>
				<a href="#help" id="help" style="color: inherit; text-decoration: none;">
					<h2>Help</h2>
				</a>
				<p>If you still have questions, you can join the support server on Discord: <a href="https://discord.gg/tk2n3naJn3">Discord server</a></p>
				<p><a href="https://discord.gg/tk2n3naJn3"><img src="https://discord.com/api/guilds/866589508392976384/widget.png?style=banner2" alt="Support server on Discord"></a></p>
				<a href="#installation" id="installation" style="color: inherit; text-decoration: none;">
					<h1>Installation</h1>
				</a>
				<p>Run <code>npm install eris-fleet</code> or with yarn: <code>yarn add eris-fleet</code>.</p>
				<p>To use a less refined, but more up-to-date branch, use <code>npm install danclay/eris-fleet#dev</code> or <code>yarn add danclay/eris-fleet#dev</code>. <a href="https://github.com/danclay/eris-fleet/tree/dev">Documentation for the dev branch.</a></p>
				<a href="#basics" id="basics" style="color: inherit; text-decoration: none;">
					<h1>Basics</h1>
				</a>
				<p>Some working examples are in <a href="https://github.com/danclay/eris-fleet/tree/master/test">test/</a>.</p>
				<a href="#naming-conventions" id="naming-conventions" style="color: inherit; text-decoration: none;">
					<h2>Naming Conventions</h2>
				</a>
				<table>
					<thead>
						<tr>
							<th>Term</th>
							<th>Description</th>
						</tr>
					</thead>
					<tbody><tr>
							<td>&quot;fleet&quot;</td>
							<td>All the components below</td>
						</tr>
						<tr>
							<td>&quot;admiral&quot;</td>
							<td>A single sharding manager</td>
						</tr>
						<tr>
							<td>&quot;worker&quot;</td>
							<td>A worker for node clustering</td>
						</tr>
						<tr>
							<td>&quot;cluster&quot;</td>
							<td>A worker containing Eris shards</td>
						</tr>
						<tr>
							<td>&quot;service&quot;</td>
							<td>A worker that does not contain Eris shards, but can interact with clusters</td>
						</tr>
				</tbody></table>
				<a href="#get-started" id="get-started" style="color: inherit; text-decoration: none;">
					<h2>Get Started</h2>
				</a>
				<p>To get started, you will need at least 2 files:</p>
				<ol>
					<li>Your file which will create the fleet. This will be called &quot;index.js&quot; for now.</li>
					<li>Your file containing your bot code. This will be called &quot;bot.js&quot; for now. This file will extend <code>BaseClusterWorker</code></li>
				</ol>
				<p>In the example below, the variable <code>options</code> is passed to the admiral. <a href="https://danclay.github.io/eris-fleet/interfaces/options.html">Read the docs</a> for what options you can pass.</p>
				<p>Here is an example of <code>index.js</code>:</p>
				<pre><code class="language-js"><span style="color: #0000FF">const</span><span style="color: #000000"> { </span><span style="color: #0070C1">isMaster</span><span style="color: #000000"> } = </span><span style="color: #795E26">require</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;cluster&#039;</span><span style="color: #000000">);</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> { </span><span style="color: #0070C1">Fleet</span><span style="color: #000000"> } = </span><span style="color: #795E26">require</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;eris-fleet&#039;</span><span style="color: #000000">);</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">path</span><span style="color: #000000"> = </span><span style="color: #795E26">require</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;path&#039;</span><span style="color: #000000">);</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> { </span><span style="color: #0070C1">inspect</span><span style="color: #000000"> } = </span><span style="color: #795E26">require</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;util&#039;</span><span style="color: #000000">);</span>

<span style="color: #795E26">require</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;dotenv&#039;</span><span style="color: #000000">).</span><span style="color: #795E26">config</span><span style="color: #000000">();</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">options</span><span style="color: #000000"> = {</span>
<span style="color: #000000">    </span><span style="color: #001080">path:</span><span style="color: #000000"> </span><span style="color: #001080">path</span><span style="color: #000000">.</span><span style="color: #795E26">join</span><span style="color: #000000">(</span><span style="color: #001080">__dirname</span><span style="color: #000000">, </span><span style="color: #A31515">&quot;./bot.js&quot;</span><span style="color: #000000">),</span>
<span style="color: #000000">    </span><span style="color: #001080">token:</span><span style="color: #000000"> </span><span style="color: #001080">process</span><span style="color: #000000">.</span><span style="color: #001080">env</span><span style="color: #000000">.</span><span style="color: #001080">token</span>
<span style="color: #000000">}</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">Admiral</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">Fleet</span><span style="color: #000000">(</span><span style="color: #001080">options</span><span style="color: #000000">);</span>

<span style="color: #AF00DB">if</span><span style="color: #000000"> (</span><span style="color: #001080">isMaster</span><span style="color: #000000">) {</span>
<span style="color: #000000">    </span><span style="color: #008000">// Code to only run for your master process</span>
<span style="color: #000000">    </span><span style="color: #001080">Admiral</span><span style="color: #000000">.</span><span style="color: #795E26">on</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;log&#039;</span><span style="color: #000000">, </span><span style="color: #001080">m</span><span style="color: #000000"> </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #001080">m</span><span style="color: #000000">));</span>
<span style="color: #000000">    </span><span style="color: #001080">Admiral</span><span style="color: #000000">.</span><span style="color: #795E26">on</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;debug&#039;</span><span style="color: #000000">, </span><span style="color: #001080">m</span><span style="color: #000000"> </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">debug</span><span style="color: #000000">(</span><span style="color: #001080">m</span><span style="color: #000000">));</span>
<span style="color: #000000">    </span><span style="color: #001080">Admiral</span><span style="color: #000000">.</span><span style="color: #795E26">on</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;warn&#039;</span><span style="color: #000000">, </span><span style="color: #001080">m</span><span style="color: #000000"> </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">warn</span><span style="color: #000000">(</span><span style="color: #001080">m</span><span style="color: #000000">));</span>
<span style="color: #000000">    </span><span style="color: #001080">Admiral</span><span style="color: #000000">.</span><span style="color: #795E26">on</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;error&#039;</span><span style="color: #000000">, </span><span style="color: #001080">m</span><span style="color: #000000"> </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">error</span><span style="color: #000000">(</span><span style="color: #795E26">inspect</span><span style="color: #000000">(</span><span style="color: #001080">m</span><span style="color: #000000">)));</span>

<span style="color: #000000">    </span><span style="color: #008000">// Logs stats when they arrive</span>
<span style="color: #000000">    </span><span style="color: #001080">Admiral</span><span style="color: #000000">.</span><span style="color: #795E26">on</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;stats&#039;</span><span style="color: #000000">, </span><span style="color: #001080">m</span><span style="color: #000000"> </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #001080">m</span><span style="color: #000000">));</span>
<span style="color: #000000">}</span>
</code></pre>
				<p>This creates a new Admiral that will manage <code>bot.js</code> running in other processes. <a href="https://danclay.github.io/eris-fleet/classes/baseclusterworker.html">More details</a></p>
				<p>The following is an example of <code>bot.js</code>. <a href="https://danclay.github.io/eris-fleet/classes/ipc.html">Read the IPC docs</a> for what you can access and do with clusters.</p>
				<pre><code class="language-js"><span style="color: #0000FF">const</span><span style="color: #000000"> { </span><span style="color: #0070C1">BaseClusterWorker</span><span style="color: #000000"> } = </span><span style="color: #795E26">require</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;eris-fleet&#039;</span><span style="color: #000000">);</span>

<span style="color: #267F99">module</span><span style="color: #000000">.</span><span style="color: #267F99">exports</span><span style="color: #000000"> = </span><span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">BotWorker</span><span style="color: #000000"> </span><span style="color: #0000FF">extends</span><span style="color: #000000"> </span><span style="color: #267F99">BaseClusterWorker</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #0000FF">constructor</span><span style="color: #000000">(</span><span style="color: #001080">setup</span><span style="color: #000000">) {</span>
<span style="color: #000000">        </span><span style="color: #008000">// Do not delete this super.</span>
<span style="color: #000000">        </span><span style="color: #0000FF">super</span><span style="color: #000000">(</span><span style="color: #001080">setup</span><span style="color: #000000">);</span>

<span style="color: #000000">        </span><span style="color: #0000FF">this</span><span style="color: #000000">.</span><span style="color: #001080">bot</span><span style="color: #000000">.</span><span style="color: #795E26">on</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;messageCreate&#039;</span><span style="color: #000000">, </span><span style="color: #0000FF">this</span><span style="color: #000000">.</span><span style="color: #001080">handleMessage</span><span style="color: #000000">.</span><span style="color: #795E26">bind</span><span style="color: #000000">(</span><span style="color: #0000FF">this</span><span style="color: #000000">));</span>

<span style="color: #000000">        </span><span style="color: #008000">// Demonstration of the properties the cluster has (Keep reading for info on IPC):</span>
<span style="color: #000000">        </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #0000FF">this</span><span style="color: #000000">.</span><span style="color: #001080">workerID</span><span style="color: #000000">); </span><span style="color: #008000">// ID of the worker</span>
<span style="color: #000000">        </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #0000FF">this</span><span style="color: #000000">.</span><span style="color: #001080">clusterID</span><span style="color: #000000">); </span><span style="color: #008000">// The ID of the cluster</span>
<span style="color: #000000">    }</span>

<span style="color: #000000">    </span><span style="color: #0000FF">async</span><span style="color: #000000"> </span><span style="color: #795E26">handleMessage</span><span style="color: #000000">(</span><span style="color: #001080">msg</span><span style="color: #000000">) {</span>
<span style="color: #000000">        </span><span style="color: #AF00DB">if</span><span style="color: #000000"> (</span><span style="color: #001080">msg</span><span style="color: #000000">.</span><span style="color: #001080">content</span><span style="color: #000000"> === </span><span style="color: #A31515">&quot;!ping&quot;</span><span style="color: #000000"> &amp;&amp; !</span><span style="color: #001080">msg</span><span style="color: #000000">.</span><span style="color: #001080">author</span><span style="color: #000000">.</span><span style="color: #001080">bot</span><span style="color: #000000">) {</span>
<span style="color: #000000">            </span><span style="color: #0000FF">this</span><span style="color: #000000">.</span><span style="color: #001080">bot</span><span style="color: #000000">.</span><span style="color: #795E26">createMessage</span><span style="color: #000000">(</span><span style="color: #001080">msg</span><span style="color: #000000">.</span><span style="color: #001080">channel</span><span style="color: #000000">.</span><span style="color: #001080">id</span><span style="color: #000000">, </span><span style="color: #A31515">&quot;Pong!&quot;</span><span style="color: #000000">);</span>
<span style="color: #000000">        }</span>
<span style="color: #000000">    }</span>

<span style="color: #000000">    </span><span style="color: #795E26">shutdown</span><span style="color: #000000">(</span><span style="color: #001080">done</span><span style="color: #000000">) {</span>
<span style="color: #000000">        </span><span style="color: #008000">// Optional function to gracefully shutdown things if you need to.</span>
<span style="color: #000000">        </span><span style="color: #795E26">done</span><span style="color: #000000">(); </span><span style="color: #008000">// Use this function when you are done gracefully shutting down.</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">}</span>
</code></pre>
				<p><strong>Make sure your bot file extends BaseClusterWorker!</strong>
				The bot above will respond with &quot;Pong!&quot; when it recieves the command &quot;!ping&quot;.</p>
				<a href="#services" id="services" style="color: inherit; text-decoration: none;">
					<h2>Services</h2>
				</a>
				<p>You can create services for your bot. Services are workers which do not interact directly with Eris. Services are useful for processing tasks, a central location to get the latest version of languages for your bot, custom statistics, and more! <a href="https://danclay.github.io/eris-fleet/classes/ipc.html">Read the IPC docs</a> for what you can access and do with services. <strong>Note that services always start before the clusters. Clusters will only start after all the services have started.</strong> <a href="https://danclay.github.io/eris-fleet/classes/baseserviceworker.html">More details</a></p>
				<p>To add a service, add the following to the options you pass to the fleet:</p>
				<pre><code class="language-js"><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">options</span><span style="color: #000000"> = {</span>
<span style="color: #000000">    </span><span style="color: #008000">// Your other options...</span>
<span style="color: #000000">    </span><span style="color: #001080">services:</span><span style="color: #000000"> [{</span><span style="color: #001080">name:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;myService&quot;</span><span style="color: #000000">, </span><span style="color: #001080">path:</span><span style="color: #000000"> </span><span style="color: #001080">path</span><span style="color: #000000">.</span><span style="color: #795E26">join</span><span style="color: #000000">(</span><span style="color: #001080">__dirname</span><span style="color: #000000">, </span><span style="color: #A31515">&quot;./service.js&quot;</span><span style="color: #000000">)}]</span>
<span style="color: #000000">}</span>
</code></pre>
				<p>Add a new array element for each service you want to register. Make sure each service has a unique name or else the fleet will crash.</p>
				<p>Here is an example of <code>service.js</code>:</p>
				<pre><code class="language-js"><span style="color: #0000FF">const</span><span style="color: #000000"> { </span><span style="color: #0070C1">BaseServiceWorker</span><span style="color: #000000"> } = </span><span style="color: #795E26">require</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;eris-fleet&#039;</span><span style="color: #000000">);</span>

<span style="color: #267F99">module</span><span style="color: #000000">.</span><span style="color: #267F99">exports</span><span style="color: #000000"> = </span><span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">ServiceWorker</span><span style="color: #000000"> </span><span style="color: #0000FF">extends</span><span style="color: #000000"> </span><span style="color: #267F99">BaseServiceWorker</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #0000FF">constructor</span><span style="color: #000000">(</span><span style="color: #001080">setup</span><span style="color: #000000">) {</span>
<span style="color: #000000">        </span><span style="color: #008000">// Do not delete this super.</span>
<span style="color: #000000">        </span><span style="color: #0000FF">super</span><span style="color: #000000">(</span><span style="color: #001080">setup</span><span style="color: #000000">);</span>

<span style="color: #000000">        </span><span style="color: #008000">// Run this function when your service is ready for use. This MUST be run for the worker spawning to continue.</span>
<span style="color: #000000">        </span><span style="color: #0000FF">this</span><span style="color: #000000">.</span><span style="color: #795E26">serviceReady</span><span style="color: #000000">();</span>

<span style="color: #000000">        </span><span style="color: #008000">// Demonstration of the properties the service has (Keep reading for info on IPC):</span>
<span style="color: #000000">        </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #0000FF">this</span><span style="color: #000000">.</span><span style="color: #001080">workerID</span><span style="color: #000000">); </span><span style="color: #008000">// ID of the worker</span>
<span style="color: #000000">        </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #0000FF">this</span><span style="color: #000000">.</span><span style="color: #001080">serviceName</span><span style="color: #000000">); </span><span style="color: #008000">// The name of the service</span>

<span style="color: #000000">    }</span>
<span style="color: #000000">    </span><span style="color: #008000">// This is the function which will handle commands</span>
<span style="color: #000000">    </span><span style="color: #0000FF">async</span><span style="color: #000000"> </span><span style="color: #795E26">handleCommand</span><span style="color: #000000">(</span><span style="color: #001080">dataSentInCommand</span><span style="color: #000000">) {</span>
<span style="color: #000000">        </span><span style="color: #008000">// Return a response if you want to respond</span>
<span style="color: #000000">        </span><span style="color: #AF00DB">return</span><span style="color: #000000"> </span><span style="color: #001080">dataSentInCommand</span><span style="color: #000000">.</span><span style="color: #001080">smileyFace</span><span style="color: #000000">;</span>
<span style="color: #000000">    }</span>

<span style="color: #000000">    </span><span style="color: #795E26">shutdown</span><span style="color: #000000">(</span><span style="color: #001080">done</span><span style="color: #000000">) {</span>
<span style="color: #000000">        </span><span style="color: #008000">// Optional function to gracefully shutdown things if you need to.</span>
<span style="color: #000000">        </span><span style="color: #795E26">done</span><span style="color: #000000">(); </span><span style="color: #008000">// Use this function when you are done gracefully shutting down.</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">}</span>
</code></pre>
				<p><strong>Make sure your service file extends BaseServiceWorker!</strong>
				This service will simply return a value within an object sent to it within the command message called &quot;smileyFace&quot;. Services can be used for much more than this though. To send a command to this service, you could use this:</p>
				<pre><code class="language-js"><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">reply</span><span style="color: #000000"> = </span><span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #0000FF">this</span><span style="color: #000000">.</span><span style="color: #001080">ipc</span><span style="color: #000000">.</span><span style="color: #795E26">command</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;myService&quot;</span><span style="color: #000000">, {</span><span style="color: #001080">smileyFace:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;:)&quot;</span><span style="color: #000000">}, </span><span style="color: #0000FF">true</span><span style="color: #000000">);</span>
<span style="color: #0000FF">this</span><span style="color: #000000">.</span><span style="color: #001080">bot</span><span style="color: #000000">.</span><span style="color: #795E26">createMessage</span><span style="color: #000000">(</span><span style="color: #001080">msg</span><span style="color: #000000">.</span><span style="color: #001080">channel</span><span style="color: #000000">.</span><span style="color: #001080">id</span><span style="color: #000000">, </span><span style="color: #001080">reply</span><span style="color: #000000">);</span>
</code></pre>
				<p>This command is being sent using the IPC. In this command, the first argument is the name of the service to send the command to, the second argument is the message to send it (in this case a simple object), and the third argument is whether you want a response (this will default to false unless you specify &quot;true&quot;). If you want a response, you must <code>await</code> the command or use <code>.then()</code>.</p>
				<a href="#handling-service-errors" id="handling-service-errors" style="color: inherit; text-decoration: none;">
					<h3>Handling service errors</h3>
				</a>
				<p>If you encounter an error while starting your service, run <code>this.serviceStartingError(&#39;error here&#39;)</code> instead of <code>this.serviceReady()</code>. Using this will report an error and restart the worker. <strong>Note that services always start before the clusters, so if your service keeps having starting errors your bot will be stuck in a loop.</strong> This issue may be fixed in the future from some sort of maxRestarts option, but this is currently not a functionality.</p>
				<p>If you encounter an error when processing a command within your service, you can do the following to reject the promise:</p>
				<pre><code class="language-js"><span style="color: #008000">// handleCommand function within the ServiceWorker class</span>
<span style="color: #001080">async</span><span style="color: #000000"> </span><span style="color: #795E26">handleCommand</span><span style="color: #000000">(</span><span style="color: #001080">dataSentInCommand</span><span style="color: #000000">) {</span>
<span style="color: #000000">    </span><span style="color: #008000">// Rejects the promise</span>
<span style="color: #000000">    </span><span style="color: #AF00DB">return</span><span style="color: #000000"> {</span><span style="color: #001080">err:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;Uh oh.. an error!&quot;</span><span style="color: #000000">};</span>
<span style="color: #000000">}</span>
</code></pre>
				<p>When sending the command, you can do the following to deal with the error:</p>
				<pre><code class="language-js"><span style="color: #0000FF">this</span><span style="color: #000000">.</span><span style="color: #001080">ipc</span><span style="color: #000000">.</span><span style="color: #795E26">command</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;myService&quot;</span><span style="color: #000000">, {</span><span style="color: #001080">smileyFace:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;:)&quot;</span><span style="color: #000000">}, </span><span style="color: #0000FF">true</span><span style="color: #000000">).</span><span style="color: #795E26">then</span><span style="color: #000000">((</span><span style="color: #001080">reply</span><span style="color: #000000">) </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #008000">// A successful response</span>
<span style="color: #000000">    </span><span style="color: #0000FF">this</span><span style="color: #000000">.</span><span style="color: #001080">bot</span><span style="color: #000000">.</span><span style="color: #795E26">createMessage</span><span style="color: #000000">(</span><span style="color: #001080">msg</span><span style="color: #000000">.</span><span style="color: #001080">channel</span><span style="color: #000000">.</span><span style="color: #001080">id</span><span style="color: #000000">, </span><span style="color: #001080">reply</span><span style="color: #000000">);</span>
<span style="color: #000000">}).</span><span style="color: #795E26">catch</span><span style="color: #000000">((</span><span style="color: #001080">e</span><span style="color: #000000">) </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #008000">// Do whatever you want with the error</span>
<span style="color: #000000">    </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">error</span><span style="color: #000000">(</span><span style="color: #001080">e</span><span style="color: #000000">);</span>
<span style="color: #000000">});</span>
</code></pre>
				<a href="#in-depth" id="in-depth" style="color: inherit; text-decoration: none;">
					<h1>In-depth</h1>
				</a>
				<p>Below is more in-depth documentation.</p>
				<a href="#admiral" id="admiral" style="color: inherit; text-decoration: none;">
					<h2>Admiral</h2>
				</a>
				<a href="#admiral-options" id="admiral-options" style="color: inherit; text-decoration: none;">
					<h3>Admiral options</h3>
				</a>
				<p>Visit <a href="https://danclay.github.io/eris-fleet/interfaces/options.html">the docs</a> for a complete list of options.</p>
				<a href="#admiral-events" id="admiral-events" style="color: inherit; text-decoration: none;">
					<h3>Admiral events</h3>
				</a>
				<p>Visit <a href="https://danclay.github.io/eris-fleet/classes/fleet.html">the docs</a> for a complete list of events.</p>
				<a href="#central-request-handler" id="central-request-handler" style="color: inherit; text-decoration: none;">
					<h3>Central Request Handler</h3>
				</a>
				<p>The central request handler forwards Eris requests to the master process where the request is sent to a single Eris request handler instance. This helps to prevent 429 errors from occuring when you have x number of clusters keeping track of ratelimiting separately. When a response is recieved, it is sent back to the cluster&#39;s Eris client.</p>
				<a href="#concurrency" id="concurrency" style="color: inherit; text-decoration: none;">
					<h3>Concurrency</h3>
				</a>
				<p>Eris-fleet supports concurrency by starting clusters at the same time based on your bot&#39;s <code>max_concurrency</code> value. The clusters are started together in groups. The <code>max_concurrency</code> value can be overridden with <a href="https://danclay.github.io/eris-fleet/interfaces/options.html#maxconcurrencyoverride">options.maxConcurrencyOverride</a></p>
				<a href="#formats" id="formats" style="color: inherit; text-decoration: none;">
					<h3>Formats</h3>
				</a>
				<p>Visit <a href="https://danclay.github.io/eris-fleet/modules.html">the docs</a> to view the Typescript interfaces.</p>
				<a href="#choose-what-to-log" id="choose-what-to-log" style="color: inherit; text-decoration: none;">
					<h3>Choose what to log</h3>
				</a>
				<p>You can choose what to log by using the <code>whatToLog</code> property in the options object. You can choose either a whitelist or a blacklist of what to log. You can select what to log by using an array. To possible array elements are shown <a href="https://danclay.github.io/eris-fleet/modules.html#loggingoptions">on the docs</a>. Here is an example of choosing what to log:</p>
				<pre><code class="language-js"><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">options</span><span style="color: #000000"> = {</span>
<span style="color: #000000">    </span><span style="color: #008000">// Your other options</span>
<span style="color: #000000">    </span><span style="color: #001080">whatToLog:</span><span style="color: #000000"> {</span>
<span style="color: #000000">        </span><span style="color: #008000">// This will only log when the admiral starts, when clusters are ready, and when services are ready.</span>
<span style="color: #000000">        </span><span style="color: #001080">whitelist:</span><span style="color: #000000"> [</span><span style="color: #A31515">&#039;admiral_start&#039;</span><span style="color: #000000">, </span><span style="color: #A31515">&#039;cluster_ready&#039;</span><span style="color: #000000">, </span><span style="color: #A31515">&#039;service_ready&#039;</span><span style="color: #000000">]</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">};</span>
</code></pre>
				<p>Change <code>whitelist</code> to <code>blacklist</code> if you want to use a blacklist. Change the array as you wish. <strong>Errors and warnings will always be sent.</strong></p>
				<a href="#ipc" id="ipc" style="color: inherit; text-decoration: none;">
					<h2>IPC</h2>
				</a>
				<p>Clusters and services can use IPC to interact with other clusters, the Admiral, and services. Visit <a href="https://danclay.github.io/eris-fleet/classes/ipc.html">the IPC docs</a> to view available methods.</p>
				<a href="#stats" id="stats" style="color: inherit; text-decoration: none;">
					<h2>Stats</h2>
				</a>
				<p>Stats are given in <a href="https://danclay.github.io/eris-fleet/interfaces/stats.html">this</a> format.</p>
				<a href="#using-a-specific-version-of-eris-or-a-modified-version-of-eris" id="using-a-specific-version-of-eris-or-a-modified-version-of-eris" style="color: inherit; text-decoration: none;">
					<h2>Using a specific version of Eris or a modified version of Eris</h2>
				</a>
				<p>You can use an extended Eris client by passing it to the Options. (see the <a href="https://danclay.github.io/eris-fleet/interfaces/options.html#customclient">options.customClient</a> section).</p>
				<p>Eris-fleet is able to use packages such as eris-additions if you desire. To do so, modify your bot file to match the following template:</p>
				<pre><code class="language-js"><span style="color: #0000FF">const</span><span style="color: #000000"> { </span><span style="color: #0070C1">BaseClusterWorker</span><span style="color: #000000"> } = </span><span style="color: #795E26">require</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;eris-fleet&#039;</span><span style="color: #000000">);</span>

<span style="color: #008000">// Example using eris-additions</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">Eris</span><span style="color: #000000"> = </span><span style="color: #795E26">require</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;eris-additions&quot;</span><span style="color: #000000">)(</span><span style="color: #795E26">require</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;eris&quot;</span><span style="color: #000000">));</span>

<span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">BotWorker</span><span style="color: #000000"> </span><span style="color: #0000FF">extends</span><span style="color: #000000"> </span><span style="color: #267F99">BaseClusterWorker</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #0000FF">constructor</span><span style="color: #000000">(</span><span style="color: #001080">setup</span><span style="color: #000000">) {</span>
<span style="color: #000000">        </span><span style="color: #0000FF">super</span><span style="color: #000000">(</span><span style="color: #001080">setup</span><span style="color: #000000">);</span>
<span style="color: #000000">        </span><span style="color: #008000">// Your cool stuff</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">}</span>

<span style="color: #008000">// This export is needed for this to work.</span>
<span style="color: #267F99">module</span><span style="color: #000000">.</span><span style="color: #267F99">exports</span><span style="color: #000000"> = {</span><span style="color: #001080">BotWorker</span><span style="color: #000000">, </span><span style="color: #001080">Eris</span><span style="color: #000000">};</span>
</code></pre>
			</div>
		</div>
		<div class="col-4 col-menu menu-sticky-wrap menu-highlight">
			<nav class="tsd-navigation primary">
				<ul>
					<li class=" ">
						<a href="modules.html">Exports</a>
					</li>
				</ul>
			</nav>
			<nav class="tsd-navigation secondary menu-sticky">
				<ul class="before-current">
					<li class=" tsd-kind-class">
						<a href="classes/baseclusterworker.html" class="tsd-kind-icon">Base<wbr>Cluster<wbr>Worker</a>
					</li>
					<li class=" tsd-kind-class">
						<a href="classes/baseserviceworker.html" class="tsd-kind-icon">Base<wbr>Service<wbr>Worker</a>
					</li>
					<li class=" tsd-kind-class">
						<a href="classes/collection.html" class="tsd-kind-icon">Collection</a>
					</li>
					<li class=" tsd-kind-class">
						<a href="classes/fleet.html" class="tsd-kind-icon">Fleet</a>
					</li>
					<li class=" tsd-kind-class">
						<a href="classes/ipc.html" class="tsd-kind-icon">IPC</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/baseclusterworkersetup.html" class="tsd-kind-icon">Base<wbr>Cluster<wbr>Worker<wbr>Setup</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/baseserviceworkersetup.html" class="tsd-kind-icon">Base<wbr>Service<wbr>Worker<wbr>Setup</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/clustercollection.html" class="tsd-kind-icon">Cluster<wbr>Collection</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/clusterstats.html" class="tsd-kind-icon">Cluster<wbr>Stats</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/objectlog.html" class="tsd-kind-icon">Object<wbr>Log</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/options.html" class="tsd-kind-icon">Options</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/reshardoptions.html" class="tsd-kind-icon">Reshard<wbr>Options</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/servicecollection.html" class="tsd-kind-icon">Service<wbr>Collection</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/servicestats.html" class="tsd-kind-icon">Service<wbr>Stats</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/shardstats.html" class="tsd-kind-icon">Shard<wbr>Stats</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/startingstatus.html" class="tsd-kind-icon">Starting<wbr>Status</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/stats.html" class="tsd-kind-icon">Stats</a>
					</li>
					<li class=" tsd-kind-type-alias">
						<a href="modules.html#loggingoptions" class="tsd-kind-icon">Logging<wbr>Options</a>
					</li>
				</ul>
			</nav>
		</div>
	</div>
</div>
<footer class="with-border-bottom">
	<div class="container">
		<h2>Legend</h2>
		<div class="tsd-legend-group">
			<ul class="tsd-legend">
				<li class="tsd-kind-constructor tsd-parent-kind-class"><span class="tsd-kind-icon">Constructor</span></li>
				<li class="tsd-kind-property tsd-parent-kind-class"><span class="tsd-kind-icon">Property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class"><span class="tsd-kind-icon">Method</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-private"><span class="tsd-kind-icon">Private property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class tsd-is-private"><span class="tsd-kind-icon">Private method</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-property tsd-parent-kind-interface"><span class="tsd-kind-icon">Property</span></li>
			</ul>
		</div>
	</div>
</footer>
<div class="container tsd-generator">
	<p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p>
</div>
<div class="overlay"></div>
<script src="assets/js/main.js"></script>
</body>
</html>